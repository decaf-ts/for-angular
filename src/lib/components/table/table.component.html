@if (showSearchbar && (data?.length || searching)) {
  <div class="dcf-grid-actions">
    <div class="dcf-grid dcf-grid-small">
      <div class="dcf-width-expand@s">
        <ngx-decaf-searchbar
          [emitEventToWindow]="false"
          [debounce]="500"
          (searchEvent)="handleSearch($event)"
        />
      </div>
      @if (filterOptions?.length) {
        <div
          class="dcf-width-1-3@s dcf-width-1-4@m dcf-select-filter-container dcf-flex dcf-flex-middle"
        >
          <ion-select
            [id]="name"
            toggleIcon="chevron-down-outline"
            expandedIcon="chevron-up-outline"
            [mode]="'md'"
            fill="outline"
            [value]="filterValue ?? ''"
            [labelPlacement]="'floating'"
            [label]="locale + '.filter.label' | translate"
            (click)="openFilterSelectOptions($event)"
            [placeholder]="locale + '.filter.label' | translate"
            interface="popover"
          >
            <ion-select-option value="">{{ locale + '.filter.all' | translate }}</ion-select-option>
            @for (option of filterOptions; track $index) {
              <ion-select-option value="{{ option.value }}">{{ option.text }}</ion-select-option>
            }
            <ion-button
              fill="clear"
              (click)="handleFilterSelectClear($event)"
              slot="end"
              size="small"
              [disabled]="!filterValue"
            >
              <ngx-decaf-icon fill="clear" slot="icon-only" [name]="'ti-input-x'" />
            </ion-button>
          </ion-select>
        </div>
      }
    </div>
  </div>
}
<div class="dcf-table-container" [class.dcf-empty]="!data?.length">
  @if (initialized && data?.length) {
    <table class="dcf-table">
      <thead>
        <tr>
          @for (header of headers; track $index) {
            <th>{{ locale + '.' + header + '.label' | translate }}</th>
          }
        </tr>
      </thead>
      <tbody>
        @for (item of items; track trackItemFn($index, item)) {
          <tr>
            @for (col of item | keyvalue; track $index) {
              @if (!['handler', 'actions', 'uid'].includes(col.key)) {
                <td
                  (click)="
                    handleAction(
                      $event,
                      col?.value.handler ? col.value.handler.handle : undefined,
                      item.uid.value,
                      OperationKeys.READ
                    )
                  "
                  [innerHTML]="col.value.value"
                ></td>
              } @else {
                @if (allowOperations && col.key !== 'handler') {
                  <td class="dcf-col-actions">
                    <div class="">
                      @if (operations?.includes(OperationKeys.UPDATE)) {
                        <ngx-decaf-icon
                          [button]="true"
                          (click)="
                            handleRedirect($event, item.uid.value, OperationKeys.UPDATE, true)
                          "
                          fill="clear"
                          slot="icon-only"
                          color="primary"
                          name="ti-edit"
                        />
                      }
                      @if (operations?.includes(OperationKeys.DELETE)) {
                        <ngx-decaf-icon
                          [button]="true"
                          (click)="
                            handleRedirect($event, item.uid.value, OperationKeys.DELETE, true)
                          "
                          fill="clear"
                          slot="icon-only"
                          color="danger"
                          name="ti-trash"
                        />
                      }
                    </div>
                  </td>
                }
              }
            }
          </tr>
        }
      </tbody>
    </table>
  } @else {
    @if (!searching) {
      <ngx-decaf-empty-state
        [title]="'component.list.empty.title' | translate"
        [subtitle]="'component.list.empty.subtitle' | translate"
        [model]="empty?.showButton ? model : undefined"
        [route]="route"
        [modelId]="modelId"
        [buttonLink]="empty?.link ?? undefined"
        [borders]="borders"
        [icon]="(item?.icon ?? 'folder-open-outline') || empty.icon"
        className="dcf-empty-data"
      />
    } @else {
      <ngx-decaf-empty-state
        icon="search-outline"
        [model]="empty?.showButton ? model : undefined"
        [route]="route"
        [modelId]="modelId"
        [borders]="borders"
        [operations]="operations"
        [body]="'small'"
        [translatable]="true"
        [title]="'component.list.search.title' | translate"
        [subtitle]="'component.list.search.subtitle' | translate: { '0': parseSearchValue() }"
        [searchValue]="searchValue"
      />
    }
  }
</div>
@if (loadMoreData && !refreshing) {
  <div class="dcf-table-pagination">
    @if (pages > 0 && !searchValue?.length) {
      <ngx-decaf-pagination
        [totalPages]="pages"
        [current]="page"
        (clickEvent)="handlePaginate($event)"
      />
    }
  </div>
}
