
@if(!indexes.length) {
  <ngx-decaf-searchbar [emitEventToWindow]="false" [debounce]="500" (searchEvent)="handleSearch($event)" />
}

<div class="dcf-grid-dcf-grid-collapse dcf-grid-match" [hidden]="!indexes.length">
  <div class="dcf-width-expand">
    <div class="dcf-filter">
      <div class="dcf-input">
        @for(filter of filterValue; track trackItemFn($index, filter?.['index'])) {
          @if(filter?.['index']) {
            <ion-chip [outline]="true">{{ filter?.['index'] }}</ion-chip>
          }
          @if(filter?.['condition']) {
            <ion-chip [outline]="true">{{ filter?.['condition'] }}</ion-chip>
          }
          @if(filter?.['value']) {
            <ion-chip [outline]="true" class="dcf-filter-value">
              {{ filter?.['value'] }}
              <ion-icon name="close" (click)="removeFilter(filter?.['value'])" size="small"></ion-icon>
            </ion-chip>
          }
        }
        <div class="dcf-width-1-1">
          <input
            fill="none"
            [(ngModel)]="value"
            (keydown.enter)="addFilter(value, $event)"
            (keydown.backspace)="clear(value)"
            (input)="handleInput($event)"
            (click)="handleFocus()"
            (blur)="handleBlur()"
            type="text"
            [readonly]="step !== 3"
            placeholder="{{ locale + (step === 3 ? '.type' : '.select') | translate }}"
            #component
          />
          @if(windowWidth >= 768) {
            <div [class]="'dcf-dropdown ' + (options.length > 0 ? ' dcf-active' : '')" #optionsFilterElement>
              <div>
                @if(filteredOptions.length > 0) {
                  @for(key of filteredOptions; track key) {
                    <div
                      class="dcf-item"
                      tabindex="0"
                      (keydown.enter)="selectOption($event, key)"
                      (click)="selectOption($event, key)">
                      {{ key }}
                    </div>
                  }
                } @else {
                  <div class="dcf-empty"
                    (click)="filteredOptions = options; value = ''"
                    tabindex="0"
                    (keydown.enter)="filteredOptions = options; value = ''"
                  >
                    {{ 'no_suggestions' | translate }}
                  </div>
                }
              </div>
            </div>
          }
        </div>
      </div>
      @if(filterValue.length > 0) {
        <div class="dcf-icon-clear">
          <ion-button fill="clear" size="small" (click)="clear()">
            <ion-icon name="trash-outline" color="dark" slot="icon-only"></ion-icon>
          </ion-button>
        </div>
      }
      <div class="dcf-icon-search">
        <ion-button fill="clear" size="small" (click)="clear()">
          <ion-icon name="search-outline" color="dark" slot="icon-only"></ion-icon>
        </ion-button>
      </div>
    </div>
    @if(windowWidth < 768) {
      <div [class]="'dcf-dropdown ' + (options.length > 0 ? ' dcf-active' : '')" #optionsFilterElement>
        <div>
          @if(filteredOptions.length > 0) {
            @for(key of filteredOptions; track key) {
              <div
                class="dcf-item"
                tabindex="0"
                (keydown.enter)="selectOption($event, key)"
                (click)="selectOption($event, key)">
                {{ key }}
              </div>
            }
          } @else {
            <div class="dcf-empty"
            (click)="filteredOptions = options; value = ''"
            tabindex="0"
            (keydown.enter)="filteredOptions = options; value = ''"
            >
              {{ 'no_suggestions' | translate }}
            </div>
          }
        </div>
      </div>
    }
  </div>
  @if(!disableSort) {
    <div class="dcf-width-1-4@m dcf-width-expand">

    </div>
  }
</div>


