<section class="dcf-layout-container">
  @if (initialized) {
    @for (row of rows; track trackItemFn($index, row); let rowIndex = $index) {
      @if (row?.cols?.length) {
        <div
          [id]="uid"
          [class]="
            (!grid ? 'dcf-layout-row ' : 'dcf-layout-row dcf-grid ' + 'dcf-grid-' + gap) +
            ' ' +
            (className || '')
          "
          [class.dcf-grid-match]="match"
          [class.dcf-grid-bordered]="borders"
        >
          @if (row?.title?.length) {
            <div class="dcf-width-1-1 dcf-grid-title">
              <h3 class="">{{ row.title | translate }}</h3>
            </div>
          }
          @for (child of row.cols; track trackItemFn($index, child.col); let colIndex = $index) {
            <div
              [class]="'dcf-grid-col ' + child.colClass"
              [class.dcf-first-column]="$index === 0"
              [class.dcf-hidden]="child.props?.hidden?.includes(operation)"
            >
              <div>
                @if (child.tag === 'ngx-decaf-crud-form') {
                  <ngx-decaf-card
                    [className]="(match ? 'dcf-height-1-1 dcf-card-layout' : '') + className"
                    [body]="cardBody"
                    [type]="cardType"
                  >
                    <ngx-decaf-model-renderer
                      [model]="child.props.name"
                      [pk]="pk"
                      (listenEvent)="handleEvent($event)"
                    />
                  </ngx-decaf-card>
                } @else {
                  @if (refreshing) {
                    <ion-item>
                      <ion-label>
                        <ion-skeleton-text [animated]="true"></ion-skeleton-text>
                        <ion-text style="width: 100%">
                          <ion-skeleton-text [animated]="true"></ion-skeleton-text>
                        </ion-text>
                      </ion-label>
                    </ion-item>
                  } @else {
                    <ngx-decaf-component-renderer
                      [tag]="child.tag"
                      [pk]="pk"
                      [className]="(match ? 'dcf-height-1-1 dcf-card-layout' : '') + className"
                      [parentForm]="parentForm || child.parentForm || child?.formGroup"
                      [children]="child?.children || []"
                      (listenEvent)="handleEvent($event)"
                      [globals]="{ props: child.props }"
                    />
                  }
                }
              </div>
            </div>
          }
        </div>
      }
    }
  }
</section>
