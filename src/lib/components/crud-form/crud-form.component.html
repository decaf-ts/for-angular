@if (operation !== 'read' && operation !== 'delete') {
  <form
    [class]="'dcf-form-grid ' + operation" #component
    [id]="rendererId"
    [formGroup]="formGroup"
    (ngSubmit)="handleSubmit($event)"
    novalidate
    [target]="target">
    @if (!children?.length) {
      <ng-content #formContent></ng-content>
    } @else {
        <ngx-decaf-layout
          [className]="'dcf-crud-form-grid'"
          [children]="children || []"
          [parentForm]="formGroup || parentForm"
          [match]="false"
          gap="small"
          [flexMode]="props.flexMode || false"
          [rows]="rows"
          [cols]="cols" />

      <!-- @for (child of children; track $index) {
        <ngx-decaf-component-renderer
          [class]="(child?.props?.className ? 'dcf-form-item ' + child.props.className : 'dcf-form-item')"
          [tag]="child?.tag"
          [projectable]="false"
          [formRoot]="formGroup"
          [children]="child?.children || []"
          [globals]="{props: child.props}"
        />
      } -->
    }
    @if (initialized) {
      <div class="dcf-buttons-grid dcf-grid dcf-grid-collapse dcf-flex dcf-flex-left">
        <div>
          <ion-button type="submit" [expand]="action ? 'block' : 'default'">
            @if (options.buttons.submit.icon) {
              <ion-icon aria-hidden="true" [slot]="options.buttons.submit.iconSlot" [name]="options.buttons.submit.icon"></ion-icon>
            }
            {{ action ? action : options.buttons.submit.text}}
          </ion-button>
        </div>
        @if (!action) {
          <div>
            <ion-button fill="clear" (click)="handleReset()">
              @if (options.buttons.clear?.icon) {
                <ion-icon  aria-hidden="true" [slot]="options.buttons.clear?.iconSlot" [name]="options.buttons.clear?.icon"></ion-icon>
              }
              Back
            </ion-button>
          </div>
        }
      </div>
    }

  </form>
} @else {
  <section [class]="'dcf-grid dcf-grid-small dcf-child-width-1-1 dcf-form-grid ' + operation" #component [id]="uid">
    @if (!children?.length) {
      <ng-content #formContent></ng-content>
    } @else {
      @for (child of children; track $index) {
        <div [class]="(child?.props?.className ? 'dcf-form-item ' + child.props.className : 'dcf-form-item')">
            <ngx-decaf-component-renderer
              [tag]="child?.tag"
              [projectable]="false"
              [children]="child?.children || []"
              [globals]="{props: child.props}"
            />
        </div>
      }
    }
  </section>
  <section [class]="'dcf-buttons-grid dcf-grid dcf-grid-collapse dcf-flex dcf-flex-left ' + operation" [id]="uid">
    @if (operation === OperationKeys.READ && modelId) {
      <div>
        <ion-button
          (click)="handleDelete()"
          color="danger"
          type="button">
          @if (options.buttons.submit.icon) {
            <ion-icon aria-hidden="true" [slot]="options.buttons.submit.iconSlot" [name]="options.buttons.submit.icon"></ion-icon>
          }
          Delete
        </ion-button>
      </div>

    }
    @if (operation === OperationKeys.CREATE || operation === OperationKeys.UPDATE) {

      <div>
        <ion-button
          type="submit">
          @if (options.buttons.submit.icon) {
            <ion-icon aria-hidden="true" [slot]="options.buttons.submit.iconSlot" [name]="options.buttons.submit.icon"></ion-icon>
          }
          {{options.buttons.submit.text}}
        </ion-button>
      </div>
    }

    @if (options.buttons.clear) {
      <div>
       <ion-button fill="clear" (click)="handleReset()">
          @if (options.buttons.clear?.icon) {
            <ion-icon  aria-hidden="true" [slot]="options.buttons.clear?.iconSlot" [name]="options.buttons.clear?.icon"></ion-icon>
          }
          {{ [OperationKeys.DELETE, OperationKeys.READ, OperationKeys.UPDATE].includes(operation) ? 'Back' : options.buttons.clear?.text}}
        </ion-button>
      </div>

    }
  </section>
}

